
#include "client.h"

int		get_ip_and_port(int ac, char **av, t_client *client)
{
  if (ac != 3)
    {
      puts("usage : ./client machine port");
      return (-1);
    }
  client->server_ip = av[1];
  client->port = atoi(av[2]);
  if (client->port < 0 || client->port > 65536)
    {
      puts("Port have to be between 0 and 65535");
      return (-1);
    }
  return (0);
}

void		init_sockaddr(t_client *client)
{
  client->s_in.sin_family = AF_INET;
  client->s_in.sin_port = htons(7272);
  client->s_in.sin_addr.s_addr = inet_addr(client->server_ip);
}

int		init_client(int ac, char **av, t_client *client)
{
  struct protoent       *pe;

  if (get_ip_and_port(ac, av, client) == -1)
    return (-1);
  pe = getprotobyname("TCP");
  if (pe == NULL)
    return (-1);
  init_sockaddr(client);
  client->socket_fd = socket(AF_INET, SOCK_STREAM, pe->p_proto);
  if (client->socket_fd == -1)
    return (-1); 
  return (0);
}
